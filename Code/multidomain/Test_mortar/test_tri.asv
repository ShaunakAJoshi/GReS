% testing mortar class generalized to triangles and quadrilaterals

quadMaster = Mesh(); 
quadSlave = Mesh(); 
quadMaster.createCartesianGrid(2,1,[0 1],[0 1],8,8);
quadSlave.createCartesianGrid(2,1,[0 1],[0 1],5,5);
mQuad = Mortar3D(1,quadMaster,quadSlave);
[Dquad,Mquad,~,~,Equad] = mQuad.computeMortarElementBased(2);
f = @(x,y) sin(x) + cos(y);
fM = f(quadMaster.coordinates(:,1),quadMaster.coordinates(:,2));
fS = E*fM;
plotFunction(quadMaster,'outMQuad',fM)
plotFunction(quadSlave,'outSQuad',fS)
%%
triMaster = Mesh(); 
triSlave = Mesh();
triMaster.importGMSHmesh('triMaster.msh');
triSlave.importGMSHmesh('triSlave.msh');
mTri = Mortar3D(1,triMaster,1,triSlave,1);
[Dtri,Mtri,~,~,Etri] = mTri.computeMortarElementBased(2);
fM = f(quadMaster.coordinates(:,1),quadMaster.coordinates(:,2));
fS = E*fM;
plotFunction(triMaster,'outMTri',fM)
plotFunction(quadSlave,'outSTri',fS)