% MULTI-AQUIFER MODEL: Non conforming grid blocks

%%
clear
close all

%%
[top,res,bot] = deal(Mesh(),Mesh(),Mesh());
top.importGMSHmesh('Mesh/Overburden.msh')
res.importGMSHmesh('Mesh/Reservoir.msh')
bot.importGMSHmesh('Mesh/Underburden.msh')
%%

% writeBCfiles('BCs/bottom_fixed','SurfBC','Dir','Poro',["x","y","z"],'botFix',0,0,bot,1);
% writeBCfiles('BCs/press_inj','NodeBC','Dir','Flow',[],'inj',0,10,421);
% writeBCfiles('BCs/press_erog','NodeBC','Dir','Flow',[],'erog',0,-10,574);
% p = find(all([res.coordinates(:,1)==1000,res.coordinates(:,2)==1000],2));
% p_c = res.coordinates(p,:);

% set up multidomain simulation
model = buildModelStruct('domains.dat');

%%
mG = MeshGlue(model,'interfaces.dat');

%% MULTIDOMAIN SOLUTION S


